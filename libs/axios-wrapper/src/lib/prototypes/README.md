# Axios "wrapper" prototypes

Here are folded working prototypes of "wrappers" for axios-based request. Prototypes should get covered by tests and demonstrate how it works, how it supposed to be used in practice.

After design of wrappers completing and successful tests passing it has to go next stage — **Template making**.

## Template making

Working prototypes in this folder intended to be used as a source for **templates**.

## Template update

Every update of template should be started with update of working prototype.

## Actual examples of using

### update-group-item.api.ts

Example for PATCH method with request `body`, `parameters` and non-void response. Suppose to be used as factory for promise single request:

```typescript
import {
    ToDoTaskBlank,
    UpdateGroupItemParameters,
    UpdateGroupItemRequest,
    UpdateGroupItemResponse
} from 'your-autogenerated-lib';

import updateGroupItem, {
  UpdateGroupItemAxiosResponse
} from 'your-autogenerated-lib/axios-wrappers/update-group-item';

function doSomething() {
  // Example of body request
  const updatedGroupItem: ToDoTaskBlank = {
    title: 'Actual title'
    description: 'Actual description in few words',
    isDone: false
  }

  // **********************************************
  // * ———> This is our main autogenerated function
  // *      has to be as simple as it possible 
  updateGroupItem(updatedGroupItem, {
    // example of passed params
    groupId: 1,
    itemId: 1
  }).then((response: UpdateGroupItemAxiosResponse) => {
    let data: UpdateGroupItemResponse;

    switch(response.status) {
      case 200:
        data = response.data as UpdateGroupItemResponse<200>;
        // .
        // .
        // .
    }
  }).catch(error => {
     // error catching
  });
}

```

You can set specified axios instance or config. But be noticed: several options are ignored (see our `AxiosSafeRequestConfig` custom type definition). For instance, `validateStatus` option decided to be always ignored in preference to custom validation and helper `pickResponseBody` using.

```typescript
import axios from 'axios';

import {
    ToDoTaskBlank,
    UpdateGroupItemParameters,
    UpdateGroupItemRequest,
    UpdateGroupItemResponse
} from 'your-autogenerated-lib';

import updateGroupItem, {
  UpdateGroupItemAxiosResponse
} from 'your-autogenerated-lib/axios-wrappers/update-group-item';

import {
  ApiUnexpectedContentTypeError,
  ApiUnexpectedStatusCodeError,
  ApiValidationError,
  pickResponseBody
} from '@codegena/axios-wrapper/helpers'; // not yet considered path

const cancelMessage = 'Request canceled by user';
const cancelToken = axios.CancelToken.source();

function doSomething() {
  // Example of body request
  const updatedGroupItem: ToDoTaskBlank = {
    title: 'Actual title'
    description: 'Actual description in few words',
    isDone: false
  }

  updateGroupItem(
    updatedGroupItem,
    {
      // example of passed params
      groupId: 1,
      itemId: 1
    },
    {
      axiosRequestConfig: {
        cancelToken: cancelToken.token
      }
    }
  ).then(
    pickResponseBody(200)
  ).then((response: UpdateGroupItemAxiosResponse<200>) => {
    // .
    // .
    // .
  }).catch((error: ApiUnexpectedContentTypeError | ApiUnexpectedStatusCodeError | ApiValidationError) => {
     // error catching
  });
}

```

Auto generated function `updateGroupItem` throws custom errors when something goes wrong:

| Error | Description |
|-------------------------------:|:--------|
| `ApiUnexpectedContentTypeError` | Response have unspecified content |
| `ApiUnexpectedStatusCodeError` | Response have unspecified status code |
| `ApiValidationError` | Wrong parameters, request body or response |

> See tests in [prototype.spec.ts](./prototype.spec.ts) — so you can see examples of using in practice.
